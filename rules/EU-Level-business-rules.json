[
  {
    "name": "GR-EU-0001",
    "active": true,
    "description": "The \"disease or  agent targeted\" must be COVID-19 of the value set list.",
    "inputParameter": "Entire HCert JSON (\"v\",\"t\",\"r\",\"..\") + Valuesets + \"tg\"",
    "jsonLogicExpression": {
      "and": [
        {
          "reduce": [
            {
              "var": "r"
            },
            {
              "and": [
                { "var": "accumulator" },
                {
                  "==": [
                    { "var": "current.tg" },
                    "840539006"
                  ]
                }
              ]
            },
            true
          ]
        },
        {
          "reduce": [
            {
              "var": "t"
            },
            {
              "and": [
                { "var": "accumulator" },
                {
                  "==": [
                    { "var": "current.tg" },
                    "840539006"
                  ]
                }
              ]
            },
            true
          ]
        },
        {
          "reduce": [
            {
              "var": "v"
            },
            {
              "and": [
                { "var": "accumulator" },
                {
                  "==": [
                    { "var": "current.tg" },
                    "840539006"
                  ]
                }
              ]
            },
            true
          ]
        }
      ]
    }
  },
  {
    "name": "VR-EU-0001",
    "businessDescription": "EMA must approve allowed vaccines.",
    "description": "Only vaccines in the allowed valueset are allowed.",
    "inputParameter": "Vaccination Part of the HCert (\"v\")+ Valuesets + (\"v\")+\"mp\"",
    "jsonLogicExpression": {
      "reduce": [
        {
          "var": "v"
        },
        {
          "and": [
            {
              "var": "accumulator"
            },
            {
              "in": [
                {
                  "var": "current.mp"
                },
                [
                  "BBIBP-CorV",
                  "CVnCoV",
                  "Convidecia",
                  "CoronaVac",
                  "Covaxin",
                  "EU/1/20/1507",
                  "EU/1/20/1525",
                  "EU/1/20/1528",
                  "EU/1/21/1529",
                  "EpiVacCorona",
                  "Inactivated-SARS-CoV-2-Vero-Cell",
                  "Sputnik-V"
                ]
              ]
            }
          ]
        },
        true
      ]
    }
  },
  {
    "name": "VR-EU-0002",
    "businessDescription": "The vaccination course must be completed to provide enough protection.",
    "description": "Vaccination doses must be equal or greater than expected doses.",
    "inputParameter": "Vaccination Part of the HCert (\"v\")+ Valuesets + \"dn\"+\"sd\"",
    "jsonLogicExpression": {
      "some": [
        {
          "map": [
            {
              "var": "v"
            },
            {
              ">=": [
                {
                  "var": "dn"
                },
                {
                  "var": "sd"
                }
              ]
            }
          ]
        },
        { "var": "" }
      ]
    }
  }
]
